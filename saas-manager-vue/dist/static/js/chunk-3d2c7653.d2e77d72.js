(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d2c7653"],{1063:function(e,t,r){"use strict";r("63f2")},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r("6b75");function n(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var o=r("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e){return n(e)||i(e)||Object(o["a"])(e)||s()}},2934:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var a=r("b775");function n(){return Object(a["a"])({url:"/common/position_list",methods:"get"})}function i(e){return Object(a["a"])({url:"/user/getAccountList",method:"post",data:e})}},"5c25":function(e,t,r){e.exports=r.p+"static/img/no-data.5dbb23e5.png"},"63f2":function(e,t,r){},a434:function(e,t,r){"use strict";var a=r("23e7"),n=r("23cb"),i=r("a691"),o=r("50c4"),s=r("7b0b"),u=r("65f0"),c=r("8418"),l=r("1dde"),d=r("ae40"),p=l("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,b=Math.min,g=9007199254740991,m="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!p||!h},{splice:function(e,t){var r,a,l,d,p,h,w=s(this),v=o(w.length),y=n(e,v),x=arguments.length;if(0===x?r=a=0:1===x?(r=0,a=v-y):(r=x-2,a=b(f(i(t),0),v-y)),v+r-a>g)throw TypeError(m);for(l=u(w,a),d=0;d<a;d++)p=y+d,p in w&&c(l,d,w[p]);if(l.length=a,r<a){for(d=y;d<v-a;d++)p=d+a,h=d+r,p in w?w[h]=w[p]:delete w[h];for(d=v;d>v-a+r;d--)delete w[d-1]}else if(r>a)for(d=v-a;d>y;d--)p=d+a-1,h=d+r-1,p in w?w[h]=w[p]:delete w[h];for(d=0;d<r;d++)w[d+y]=arguments[d+2];return w.length=v-a+r,l}})},b562:function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"e",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"k",(function(){return u})),r.d(t,"j",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"h",(function(){return h})),r.d(t,"g",(function(){return f}));var a=r("b775");function n(){return Object(a["a"])({url:"/app/list",method:"get"})}function i(e){return Object(a["a"])({url:"/app/getAppListByRole",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/app/pager",method:"post",data:e})}function s(e){return Object(a["a"])({url:"/app/add",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/app/update",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/aggregate/platformList/"+e,method:"post"})}function l(e){return Object(a["a"])({url:"/dashboard/getAdminAndAppListByBusinessId",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/dashboard/getAppListByAdminId",method:"post",data:e})}function p(){return Object(a["a"])({url:"/user/adminList",method:"get"})}function h(){return Object(a["a"])({url:"/app/getMediaAppList",method:"get"})}function f(e){return Object(a["a"])({url:"/app/getApplistByUserIdAndOs",method:"post",data:e})}},c37d:function(e,t,r){"use strict";r.d(t,"l",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"r",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return p})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return f})),r.d(t,"t",(function(){return b})),r.d(t,"u",(function(){return g})),r.d(t,"n",(function(){return m})),r.d(t,"o",(function(){return w})),r.d(t,"p",(function(){return v})),r.d(t,"a",(function(){return y})),r.d(t,"q",(function(){return x})),r.d(t,"k",(function(){return L})),r.d(t,"s",(function(){return k})),r.d(t,"m",(function(){return O}));var a=r("b775");function n(e){return Object(a["a"])({url:"/report/fullReport",method:"post",data:e})}function i(){return Object(a["a"])({url:"/plat/platList",method:"get"})}function o(e){return Object(a["a"])({url:"/plat/platListByUser",method:"post",data:e})}function s(){return Object(a["a"])({url:"/aggregate/groupList",method:"get"})}function u(){return Object(a["a"])({url:"/app/channelList",method:"get"})}function c(){return Object(a["a"])({url:"/aggregate/sourceList",method:"get"})}function l(e){return Object(a["a"])({url:"/aggregate/groupListByApp",method:"post",data:e})}function d(e){return Object(a["a"])({url:"/place/listByAppIds",method:"post",data:e})}function p(e){return Object(a["a"])({url:"aggregate/sourceListByApp",method:"post",data:e})}function h(e){return Object(a["a"])({url:"/aggregate/sourceListByAdplace",method:"post",data:e})}function f(e){return Object(a["a"])({url:"aggregate/groupListByAdplace",method:"post",data:e})}function b(e){return Object(a["a"])({url:"/userBehavior/report",method:"post",data:e})}function g(e){return Object(a["a"])({url:"/userBehavior/trend",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/report/hourTrend",method:"post",data:e})}function w(e){return Object(a["a"])({url:"/report/hourReport",method:"post",data:e})}function v(e){return Object(a["a"])({url:"/report/upload",method:"post",data:e})}function y(e){return Object(a["a"])({url:"/report/record",method:"post",data:e})}function x(e){return Object(a["a"])({url:"/app/tradeList",method:"get",data:e})}function L(e){return Object(a["a"])({url:"/report/getMediaReport",method:"post",data:e})}function k(e){return Object(a["a"])({url:"/place/updateMediaReportInfo",method:"post",data:e})}function O(e){return Object(a["a"])({url:"/report/chart",method:"post",data:e})}},fcc1:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r("1da1"),n=(r("96cf"),r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d"),r("9861"),r("4de4"),r("ac1f"),r("1276"),r("00b4"),r("5319"),r("4d63"),r("2c3e"),r("25f0"),r("b0c0"),r("5f72"));var i=function(e){var t=new FileReader;return new Promise((function(r,a){t.onload=function(e){r(t.result)},t.readAsText(e,"utf-8")}))};function o(e){return s.apply(this,arguments)}function s(){return s=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:"未命名.xls",e.next=3,i(t);case 3:a=e.sent;try{o=JSON.parse(a),s=o.rspMsg||o.msg,n["Notification"].warning({title:"提示",message:s+""})}catch(d){u=window.URL.createObjectURL(t),c=document.createElement("a"),c.download=r,c.href=u,c.click(),URL.revokeObjectURL(u)}case 5:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}},fe05:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"media-report-contianer"},[r("div",{staticClass:"search"},[r("el-row",[r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("el-date-picker",{staticStyle:{width:"90%"},attrs:{clearable:!1,type:"daterange","value-format":"yyyy-MM-dd",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.getSTime},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1),"MEDIA"!==e.$store.state.user.roles[0]?r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("el-select",{staticStyle:{width:"90%"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择媒体"},model:{value:e.query.mediaIds,callback:function(t){e.$set(e.query,"mediaIds",t)},expression:"query.mediaIds"}},e._l(e.mediaList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1):e._e(),r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("CustSelectApp",{staticStyle:{width:"90%"},attrs:{word:"应用",width:450,"all-data":e.appList,"search-by-id":""},on:{selectListhandle:e.selectappListhandleApp}})],1),r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("CustSelectApp",{staticStyle:{width:"90%"},attrs:{word:"广告位",width:450,"all-data":e.adplaceLsit,"search-by-id":""},on:{selectListhandle:e.selectappListhandlePlace}})],1),r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("el-select",{staticStyle:{width:"90%"},attrs:{multiple:"","collapse-tags":"",placeholder:"广告样式"},model:{value:e.query.positionIdList,callback:function(t){e.$set(e.query,"positionIdList",t)},expression:"query.positionIdList"}},e._l(e.positionList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("el-select",{staticStyle:{width:"90%"},attrs:{"collapse-tags":"",placeholder:"操作系统"},model:{value:e.query.osIdList[0],callback:function(t){e.$set(e.query.osIdList,0,t)},expression:"query.osIdList[0]"}},[r("el-option",{attrs:{label:"Android",value:1}}),r("el-option",{attrs:{label:"IOS",value:0}})],1)],1),r("el-col",{staticStyle:{width:"25%",height:"40px","margin-top":"10px"},attrs:{lg:6}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v(" 查询 ")])],1)],1)],1),r("div",{staticClass:"table"},[r("div",{staticClass:"group_box"},[r("div",{staticClass:"left"},[r("h2",{staticStyle:{display:"inline-block"}},[e._v(" 数据维度 ")]),r("div",{staticStyle:{display:"inline-block","margin-left":"30px"}},["MEDIA"!==e.$store.state.user.roles[0]?r("el-checkbox",{attrs:{medium:""},model:{value:e.showTable.media,callback:function(t){e.$set(e.showTable,"media",t)},expression:"showTable.media"}},[r("h3",[e._v("媒体账户")])]):e._e(),r("el-checkbox",{attrs:{medium:""},model:{value:e.showTable.app,callback:function(t){e.$set(e.showTable,"app",t)},expression:"showTable.app"}},[r("h3",[e._v("应用")])]),r("el-checkbox",{attrs:{medium:""},model:{value:e.showTable.place,callback:function(t){e.$set(e.showTable,"place",t)},expression:"showTable.place"}},[r("h3",[e._v("广告位")])]),r("el-checkbox",{attrs:{medium:""},model:{value:e.showTable.position,callback:function(t){e.$set(e.showTable,"position",t)},expression:"showTable.position"}},[r("h3",[e._v("广告样式")])]),r("el-checkbox",{attrs:{medium:""},model:{value:e.showTable.os,callback:function(t){e.$set(e.showTable,"os",t)},expression:"showTable.os"}},[r("h3",[e._v("操作系统")])])],1)]),r("div",{staticClass:"right_btn"},["ADMIN"==e.$store.getters.roles[0]?r("div",[r("span",{staticStyle:{"font-weight":"bold","line-height":"30px"}},[e._v(" 报表审核权限 ")]),r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},on:{change:e.changeAudit},model:{value:e.audit,callback:function(t){e.audit=t},expression:"audit"}})],1):e._e(),r("el-button",{attrs:{disabled:!e.allowDownload,type:"primary",size:"mini",loading:e.downLoading},on:{click:e.downloadReport}},[e._v(" 数据导出 ")])],1)]),e.tableList.length>1?r("div",{staticClass:"table_box"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],key:e.tableKey,attrs:{stripe:"",data:e.tableList,"header-cell-style":{background:"#f7f8fa",color:"#000"}},on:{"sort-change":e.sortChange}},[r("el-table-column",{attrs:{sortable:"custom",align:"center",fixed:"",prop:"date",label:"日期"}}),e.showTable.media&&"MEDIA"!==e.$store.state.user.roles[0]?r("el-table-column",{attrs:{align:"center",fixed:"",prop:"userName",label:"媒体账户"}}):e._e(),e.showTable.app?r("el-table-column",{attrs:{align:"center",fixed:"",prop:"appName",label:"应用"}}):e._e(),e.showTable.place?r("el-table-column",{attrs:{width:"200px",align:"center",fixed:"",prop:"name",label:"广告位"}}):e._e(),e.showTable.position?r("el-table-column",{attrs:{align:"center",fixed:"",prop:"positionName",label:"广告样式"}}):e._e(),e.showTable.os?r("el-table-column",{attrs:{align:"center",fixed:"",prop:"os",label:"操作系统",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(1===r.os?"Android":0===r.os?"IOS":"-")+" ")]}}],null,!1,92279289)}):e._e(),"MEDIA"!==e.$store.state.user.roles[0]?r("el-table-column",{attrs:{sortable:"custom",align:"center",prop:"unitRevenue",label:"收益"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.unitRevenue.toFixed(2))+" ")]}}],null,!1,296248723)}):e._e(),"MEDIA"!==e.$store.state.user.roles[0]?r("el-table-column",{attrs:{align:"center",label:"分成比例",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e.showTable.place?e._e():r("p",[e._v(" "+e._s(a.divideIntoProportions+"%")+" ")]),e.showTable.place&&"汇总"===a.date?r("p",[e._v(" "+e._s(a.divideIntoProportions+"%")+" ")]):e._e(),e.showTable.place&&"汇总"!==a.date?r("el-input",{staticStyle:{width:"80px"},attrs:{type:"number",min:"0"},on:{change:function(t){return e.handleUpdateDivideIntoProportions(a,t)}},model:{value:a.divideIntoProportions,callback:function(t){e.$set(a,"divideIntoProportions",e._n(t))},expression:"row.divideIntoProportions"}}):e._e(),e.showTable.place&&"汇总"!==a.date?r("span",[e._v("%")]):e._e()]}}],null,!1,2945699089)}):e._e(),r("el-table-column",{attrs:{sortable:"custom",align:"center",prop:"mediaUnitRevenue",label:"媒体收益"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.mediaUnitRevenue.toFixed(2))+" ")]}}],null,!1,2294044087)}),r("el-table-column",{attrs:{align:"center",prop:"impress",label:"展示"}}),r("el-table-column",{attrs:{sortable:"custom",align:"center",prop:"ecpm",label:"eCPM"}}),r("el-table-column",{attrs:{align:"center",prop:"click",label:"点击"}}),r("el-table-column",{attrs:{align:"center",prop:"clickRate",label:"点击率"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[e._v(" "+e._s(r.clickRate+"%")+" ")]}}],null,!1,2460547485)}),"MEDIA"!==e.$store.getters.roles[0]&&1==e.$store.getters.audit&&(e.showTable.app||e.showTable.place)?r("el-table-column",{attrs:{align:"center",prop:"auditSts",label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return["1"===a.auditSts||"0"===a.auditSts?r("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:function(t){return e.handleUpdateAuditSts(a,t)}},model:{value:a.auditSts,callback:function(t){e.$set(a,"auditSts",t)},expression:"row.auditSts"}}):e._e()]}}],null,!1,4022234485)}):e._e()],1),r("el-pagination",{staticStyle:{margin:"30px 0 0 0"},attrs:{"current-page":e.query.page,"page-sizes":[5,10,20,30,40],"page-size":e.query.limit,layout:"total,sizes,prev,pager,next,jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):r("Empty",{staticClass:"empty_box",attrs:{"style-obj":{fontSize:"20px"}}})],1)])},n=[],i=r("2909"),o=r("1da1"),s=(r("96cf"),r("99af"),r("d81d"),r("4de4"),r("d3b7"),r("59c5")),u=r("2934"),c=r("c37d"),l=r("fa47"),d=r("b562"),p=r("b775"),h=r("fcc1"),f={name:"MediaReport",components:{CustSelectApp:s["a"],Empty:l["a"]},data:function(){return{audit:1,tableKey:""+new Date,query:{appIdList:[],dateEnd:"",dateStart:"",placeIdList:[],positionIdList:[],osIdList:[],groupByList:[],limit:10,page:1,mediaIds:[],sortOrder:1,sortBy:"date"},isLoading:!1,tableList:[],total:0,appList:[],adplaceLsit:[],positionList:[],mediaList:[],showTable:{app:!1,place:!1,position:!1,os:!1,media:!1},date:[],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()||e.getTime()<16330176e5},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-6048e5),e.$emit("pick",[r,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-2592e6),e.$emit("pick",[r,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-7776e6),e.$emit("pick",[r,t])}}]},adplaceSelectAll:!1,downLoading:!1,updateAuditSts:{id:"",auditSts:"",date:""},updateDivideIntoProportions:{id:"",divideIntoProportions:"",date:""}}},computed:{allowDownload:function(){return this.$store.getters.allowDownload}},watch:{"showTable.media":{handler:function(){this.query.page=1,this.getMediaReport()}},"showTable.app":{handler:function(){this.query.page=1,this.getMediaReport()}},"showTable.position":{handler:function(){this.query.page=1,this.getMediaReport()}},"showTable.place":{handler:function(){this.query.page=1,this.getMediaReport()}},"showTable.os":{handler:function(){this.query.page=1,this.getMediaReport()}},"query.mediaIds":{handler:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(e.length>0)){r.next=21;break}a=[],n=0;case 3:if(!(n<e.length)){r.next=13;break}return r.next=6,Object(d["d"])({id:e[n]});case 6:if(o=r.sent,200===o.code){r.next=9;break}return r.abrupt("return");case 9:a=[].concat(Object(i["a"])(a),Object(i["a"])(o.data));case 10:n++,r.next=3;break;case 13:if(t.appList=a,a=a.map((function(e){return e.id})),0!=a.length){r.next=18;break}return t.adplaceLsit=[],r.abrupt("return");case 18:Object(c["e"])(a).then((function(e){200===e.code&&(t.adplaceLsit=e.data)})),r.next=22;break;case 21:0===t.mediaList.length?(t.appList=[],t.adplaceLsit=[]):(t.getAppList(),t.getPlaceList());case 22:case"end":return r.stop()}}),r)})))()}},"query.appIdList":{handler:function(e){e.length>0?0===this.appList.length?this.adplaceLsit=[]:this.getPlaceListByappid():this.adplaceLsit=[]}}},created:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initDate();case 2:return t.next=4,e.getAppList();case 4:return t.next=6,e.getPlaceList();case 6:return t.next=8,e.getPositionList();case 8:return t.next=10,e.getMediaList();case 10:return t.next=12,e.getMediaReport();case 12:case"end":return t.stop()}}),t)})))()},mounted:function(){this.audit=this.$store.getters.audit},methods:{changeAudit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["s"])({audit:t.audit});case 2:e.sent,t.$store.dispatch("user/getInfo");case 4:case"end":return e.stop()}}),e)})))()},downloadReport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.downLoading=!0,r=["date","userName","appName","name","positionName","os","unitRevenue","divideIntoProportions","mediaUnitRevenue","impress","ecpm","click","clickRate","auditSts"],a=["日期","媒体账户","应用","广告位","广告样式","操作系统","收益","分成比例","媒体收益","展示","eCPM","点击","点击率","审核状态"],1==e.$store.getters.audit&&"MEDIA"!==e.$store.state.user.roles[0]||(r=r.filter((function(e){return"auditSts"!==e})),a=a.filter((function(e){return"审核状态"!==e}))),"MEDIA"===e.$store.state.user.roles[0]&&(r=r.filter((function(e){return"userName"!==e})),a=a.filter((function(e){return"媒体账户"!==e})),r=r.filter((function(e){return"unitRevenue"!==e})),a=a.filter((function(e){return"收益"!==e})),r=r.filter((function(e){return"divideIntoProportions"!==e})),a=a.filter((function(e){return"分成比例"!==e})),r=r.filter((function(e){return"auditSts"!==e})),a=a.filter((function(e){return"审核状态"!==e}))),e.showTable.media||(r=r.filter((function(e){return"userName"!==e})),a=a.filter((function(e){return"媒体账户"!==e}))),e.showTable.app||(r=r.filter((function(e){return"appName"!==e})),a=a.filter((function(e){return"应用"!==e}))),e.showTable.place||(r=r.filter((function(e){return"name"!==e})),a=a.filter((function(e){return"广告位"!==e}))),e.showTable.position||(r=r.filter((function(e){return"positionName"!==e})),a=a.filter((function(e){return"广告样式"!==e}))),e.showTable.os||(r=r.filter((function(e){return"os"!==e})),a=a.filter((function(e){return"操作系统"!==e}))),e.showTable.app||e.showTable.place||(r=r.filter((function(e){return"auditSts"!==e})),a=a.filter((function(e){return"审核状态"!==e}))),e.query.codeList=r,e.query.nameList=a,t.prev=13,t.next=16,e.exportToExcel();case 16:return n=t.sent,t.next=19,Object(h["a"])(n,"mediaReport.xlsx");case 19:t.next=23;break;case 21:t.prev=21,t.t0=t["catch"](13);case 23:e.downLoading=!1;case 24:case"end":return t.stop()}}),t,null,[[13,21]])})))()},exportToExcel:function(){return p["a"].post("/report/downloadMediaReport",this.query,{responseType:"blob"})},initDate:function(){var e=(new Date).getTime()-864e5,t=new Date(e).getFullYear(),r=new Date(e).getMonth()+1,a=new Date(e).getDate(),n="".concat(t,"-").concat(r<10?"0"+r:r,"-").concat(a<10?"0"+a:a);this.date=[n,n],this.query.dateEnd=n,this.query.dateStart=n},getSTime:function(e){this.query.dateStart=e[0],this.query.dateEnd=e[1]},getMediaList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])({role:7});case 2:if(r=t.sent,200===r.code){t.next=5;break}return t.abrupt("return");case 5:e.mediaList=r.data;case 6:case"end":return t.stop()}}),t)})))()},selectappListhandleApp:function(e){this.query.appIdList=Object(i["a"])(e)},selectappListhandlePlace:function(e){this.query.placeIdList=Object(i["a"])(e)},getAppList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={},"MEDIA"!==e.$store.state.user.roles[0]){t.next=7;break}return t.next=4,Object(d["c"])();case 4:r=t.sent,t.next=10;break;case 7:return t.next=9,Object(d["h"])();case 9:r=t.sent;case 10:if(200===r.code){t.next=12;break}return t.abrupt("return");case 12:e.appList=r.data;case 13:case"end":return t.stop()}}),t)})))()},getPlaceList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.appList.map((function(e){return e.id})),0!==r.length){t.next=5;break}e.adplaceLsit=[],t.next=14;break;case 5:return t.next=7,Object(c["e"])(r);case 7:if(a=t.sent,200===a.code){t.next=10;break}return t.abrupt("return");case 10:if(a.data){t.next=13;break}return e.adplaceLsit=[],t.abrupt("return");case 13:e.adplaceLsit=a.data;case 14:case"end":return t.stop()}}),t)})))()},adplaceIdchange:function(e){this.query.placeIdList=e},getPositionList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["a"])();case 2:if(r=t.sent,200===r.code){t.next=5;break}return t.abrupt("return");case 5:e.positionList=r.data;case 6:case"end":return t.stop()}}),t)})))()},handleSearch:function(){this.query.page=1,this.getMediaReport()},getMediaReport:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,e.query.groupByList=[],e.query.groupByList.push("a.date"),(e.query.mediaIds.length>0||e.showTable.media)&&e.query.groupByList.push("sual.user_id"),(e.query.appIdList.length>0||e.showTable.app)&&e.query.groupByList.push("a.app_id"),(e.query.placeIdList.length>0||e.showTable.place)&&e.query.groupByList.push("a.place_id"),(e.query.positionIdList.length>0||e.showTable.position)&&e.query.groupByList.push("a.position_id"),(e.query.osIdList.length>0||e.showTable.os)&&e.query.groupByList.push("app.os"),""===e.query.osIdList[0]&&(e.query.osIdList=[]),t.next=11,Object(c["k"])(e.query);case 11:if(r=t.sent,200===r.code){t.next=14;break}return t.abrupt("return");case 14:if(r.data&&0!==r.data.items.length){t.next=17;break}return e.tableList=[],t.abrupt("return");case 17:e.tableList=r.data.items,e.tableList[0].os="-",e.total=r.data.total,e.$bus.$emit("totop"),e.isLoading=!1,e.tableKey=""+new Date;case 23:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.query.limit=e,this.getMediaReport()},handleCurrentChange:function(e){this.query.page=e,this.getMediaReport()},getPlaceListByappid:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return 0===e.query.appIdList.length&&(e.adplaceLsit=[]),t.next=3,Object(c["e"])(e.query.appIdList);case 3:if(r=t.sent,200===r.code){t.next=6;break}return t.abrupt("return");case 6:e.adplaceLsit=r.data;case 7:case"end":return t.stop()}}),t)})))()},sortChange:function(e){e.column;var t=e.prop,r=e.order;this.query.sortBy=t,this.query.sortOrder="ascending"==r?0:1,this.getMediaReport()},updateMediaReportInfo:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(c["s"])(e);case 2:if(a=r.sent,t.getMediaReport(),200===a.code){r.next=6;break}return r.abrupt("return",t.$message.error("操作失败"));case 6:return r.abrupt("return",t.$message.success("操作成功"));case 7:case"end":return r.stop()}}),r)})))()},handleUpdateAuditSts:function(e,t){this.showTable.place?(this.updateAuditSts.id=e.id,this.updateAuditSts.appId=""):this.showTable.app&&(this.updateAuditSts.appId=e.appId,this.updateAuditSts.id=""),this.updateAuditSts.auditSts=t,this.updateAuditSts.date=e.date,this.updateMediaReportInfo(this.updateAuditSts)},handleUpdateDivideIntoProportions:function(e,t){this.updateDivideIntoProportions.id=e.id,this.updateDivideIntoProportions.divideIntoProportions=t,this.updateDivideIntoProportions.date=e.date,this.updateMediaReportInfo(this.updateDivideIntoProportions)}}},b=f,g=(r("1063"),r("2877")),m=Object(g["a"])(b,a,n,!1,null,"557fb4fc",null);t["default"]=m.exports}}]);