(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5739ff48"],{"1b2a":function(t,e,a){},"1bf0":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-select",{staticClass:"filter-item",attrs:{placeholder:"广告源",filterable:""},model:{value:t.uploadParams.platId,callback:function(e){t.$set(t.uploadParams,"platId",e)},expression:"uploadParams.platId"}},t._l(t.platformList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-select",{staticClass:"filter-item",attrs:{placeholder:"状态",clearable:""},on:{clear:t.clearStatus},model:{value:t.uploadParams.status,callback:function(e){t.$set(t.uploadParams,"status",e)},expression:"uploadParams.status"}},t._l(t.statusList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchBtn}},[t._v(" 查询 ")])],1),a("div",{staticClass:"body-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.changeUploadDialog}},[t._v(" 上传数据文件 ")])],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTable,expression:"loadingTable"}],staticClass:"tableList_box"},[t.isEmpty?a("Empty"):a("el-table",{staticClass:"uploadTable",staticStyle:{width:"100%"},attrs:{data:t.uploadData,"header-cell-style":{background:"#f7f8fa",color:"#000"}}},[a("el-table-column",{attrs:{type:"index",label:"ID",align:"center",width:"44"}}),a("el-table-column",{attrs:{prop:"platform",label:"广告源",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"账号信息",align:"center"}}),a("el-table-column",{attrs:{label:"数据开始时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[3===r.status?a("div",[t._v(" "+t._s(r.beginDate)+" ")]):a("div",[t._v(" - ")])]}}],null,!1,1929108307)}),a("el-table-column",{attrs:{label:"数据结束时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[3===r.status?a("div",[t._v(" "+t._s(r.endDate)+" ")]):a("div",[t._v(" - ")])]}}],null,!1,943855451)}),a("el-table-column",{attrs:{label:"上传时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("div",[t._v(t._s(t._f("toDate")(r.createTime,"YYYY-MM-DD hh:mm:ss")))])]}}],null,!1,1510320600)}),a("el-table-column",{attrs:{label:"完成时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("div",[t._v(t._s(t._f("toDate")(r.updateTime,"YYYY-MM-DD hh:mm:ss")))])]}}],null,!1,3723754285)}),a("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[3===r.status?a("el-tag",{attrs:{type:"success"}},[t._v(" 处理成功 ")]):1===r.status?a("el-tag",{attrs:{type:"danger"}},[t._v(" 上传失败 ")]):t._e(),2===r.status?a("el-tag",{attrs:{type:"warning"}},[t._v(" 处理中 ")]):t._e(),4===r.status?a("el-tooltip",{attrs:{content:r.description,placement:"top-start"}},[a("el-tag",{attrs:{type:"danger"}},[t._v(" 处理失败 ")])],1):t._e()]}}],null,!1,631771975)})],1)],1)]),t.isEmpty?t._e():a("el-pagination",{attrs:{"current-page":t.uploadParams.page,"page-sizes":[10,20,30,40],"page-size":t.uploadParams.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-dialog",{ref:"uploadDialog",staticClass:"uploadDialog",attrs:{title:"上传三方数据",visible:t.uploadDialog,width:"30%"},on:{"update:visible":function(e){t.uploadDialog=e},close:t.closeUploadDialog}},[a("el-alert",{staticClass:"el-alert",attrs:{closable:!1,title:"一次最多上传31天数据","show-icon":"",type:"warning"}}),a("el-form",{ref:"uploadForm",staticClass:"uploadForm",attrs:{rules:t.uploadFormRules,model:t.uploadForm,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"广告源",prop:"platId"}},[a("el-select",{attrs:{placeholder:"广告源",filterable:""},on:{change:t.changeePlatId},model:{value:t.uploadForm.platId,callback:function(e){t.$set(t.uploadForm,"platId",e)},expression:"uploadForm.platId"}},t._l(t.platformList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"上传报表"}},[a("el-upload",{ref:"fileRef",attrs:{disabled:!t.allowOperate,action:"#","on-remove":t.removeFile,limit:1,"auto-upload":!1,"on-change":t.handleChange}},[a("el-button",{attrs:{disabled:!t.allowOperate,size:"small",type:"primary"}},[t._v(" 点击上传 ")])],1)],1),1==t.accessType?a("el-form-item",{attrs:{label:"下载模板"}},[a("el-button",{attrs:{disabled:t.downloadTempLoading,size:"small",type:"primary"},on:{click:t.downloadTemplate}},[t._v(" 点击下载 ")])],1):t._e(),t.isMedPro?a("p",{staticClass:"soUpload"},[a("a",{attrs:{target:"_blank",href:"https://creative.medproad.com/medpro/html/rule.html"}},[t._v("如何在三方后台下载数据？")])]):t._e()],1),t.allowOperate?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.uploadDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addUpload}},[t._v("确 定")])],1):t._e()],1)],1)},n=[],o=a("1da1"),l=(a("d3b7"),a("159b"),a("e9c4"),a("96cf"),a("c37d")),s=a("fa47"),i=a("b775"),u=a("fcc1"),c={components:{Empty:s["a"]},data:function(){return{platformList:[],uploadDialog:!1,isEmpty:!1,total:0,loadingTable:!1,uploadParams:{page:1,limit:10,platId:"",status:""},uploadForm:{platId:"",file:""},uploadData:[],statusItem:"",statusList:[{label:"上传失败",value:1},{label:"处理中",value:2},{label:"处理成功",value:3},{label:"处理失败",value:4}],uploadFormRules:{platId:[{required:!0,message:"请选择广告源",trigger:"blur"}]},downloadTempLoading:!1,accessType:""}},computed:{isMedPro:function(){return this.$store.getters.isMedPro},allowOperate:function(){return this.$store.getters.allowOperate}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getReportList();case 2:return e.next=4,t.getAdvertPlatform();case 4:case"end":return e.stop()}}),e)})))()},methods:{getAdvertPlatform:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["b"])();case 2:if(a=e.sent,200==a.code){e.next=5;break}return e.abrupt("return",t.$message.error(a.msg));case 5:a.data.unshift({name:"全部",id:"全部"}),a.data.forEach((function(t){t.id=""+t.id})),t.platformList=a.data;case 8:case"end":return e.stop()}}),e)})))()},getReportList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=JSON.parse(JSON.stringify(t.uploadParams)),"全部"==a.platId&&(a.platId=""),t.loadingTable=!0,e.next=5,Object(l["a"])(a);case 5:if(r=e.sent,200==r.code){e.next=8;break}return e.abrupt("return",t.$message.error(r.msg));case 8:setTimeout((function(){t.loadingTable=!1}),400),0===r.data.items.length?t.isEmpty=!0:t.isEmpty=!1,t.uploadData=r.data.items,t.total=r.data.total,t.$bus.$emit("totop");case 13:case"end":return e.stop()}}),e)})))()},searchBtn:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.uploadParams.page=1,t.uploadParams=Object.assign({},t.uploadParams),e.next=4,t.getReportList();case 4:case"end":return e.stop()}}),e)})))()},handleSizeChange:function(t){this.uploadParams.limit=t,this.getReportList()},handleCurrentChange:function(t){this.uploadParams.page=t,this.getReportList()},handleChange:function(t){this.uploadForm.file=t.raw},changeUploadDialog:function(){this.accessType="",this.uploadDialog=!0},changeePlatId:function(t){var e=this;this.platformList.forEach((function(a){a.id==t&&(e.accessType=a.accessType)}))},downloadTemplate:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.downloadTempLoading=!0,e.next=3,t.exportToExcel();case 3:return a=e.sent,e.next=6,Object(u["a"])(a,"三方数据模板.xlsx");case 6:t.downloadTempLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},exportToExcel:function(){return i["a"].post("/report/downloadTemplate",{},{responseType:"blob"})},clearStatus:function(){this.uploadParams.status="",this.getReportList()},closeUploadDialog:function(){this.uploadForm.platId="",this.uploadForm.file="",this.$refs.fileRef.clearFiles(),this.$refs.uploadForm.resetFields()},removeFile:function(){this.uploadForm.file=""},addUpload:function(){var t=this;this.$refs.uploadForm.validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(t.uploadForm.file){e.next=4;break}return e.abrupt("return",t.$message.warning("请上传报表!"));case 4:return r=new FormData,r.append("platId",t.uploadForm.platId),r.append("file",t.uploadForm.file),e.next=9,Object(l["p"])(r);case 9:if(n=e.sent,200==n.code){e.next=12;break}return e.abrupt("return",t.$message.error(n.msg));case 12:t.getReportList(),t.uploadDialog=!1,t.$message.success("添加成功");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},d=c,p=(a("1e02"),a("2877")),f=Object(p["a"])(d,r,n,!1,null,"59821cd6",null);e["default"]=f.exports},"1e02":function(t,e,a){"use strict";a("1b2a")},"5c25":function(t,e,a){t.exports=a.p+"static/img/no-data.5dbb23e5.png"},c37d:function(t,e,a){"use strict";a.d(e,"l",(function(){return n})),a.d(e,"b",(function(){return o})),a.d(e,"r",(function(){return l})),a.d(e,"i",(function(){return s})),a.d(e,"j",(function(){return i})),a.d(e,"h",(function(){return u})),a.d(e,"g",(function(){return c})),a.d(e,"e",(function(){return d})),a.d(e,"f",(function(){return p})),a.d(e,"c",(function(){return f})),a.d(e,"d",(function(){return m})),a.d(e,"t",(function(){return g})),a.d(e,"u",(function(){return b})),a.d(e,"n",(function(){return h})),a.d(e,"o",(function(){return v})),a.d(e,"p",(function(){return w})),a.d(e,"a",(function(){return y})),a.d(e,"q",(function(){return O})),a.d(e,"k",(function(){return _})),a.d(e,"s",(function(){return x})),a.d(e,"m",(function(){return j}));var r=a("b775");function n(t){return Object(r["a"])({url:"/report/fullReport",method:"post",data:t})}function o(){return Object(r["a"])({url:"/plat/platList",method:"get"})}function l(t){return Object(r["a"])({url:"/plat/platListByUser",method:"post",data:t})}function s(){return Object(r["a"])({url:"/aggregate/groupList",method:"get"})}function i(){return Object(r["a"])({url:"/app/channelList",method:"get"})}function u(){return Object(r["a"])({url:"/aggregate/sourceList",method:"get"})}function c(t){return Object(r["a"])({url:"/aggregate/groupListByApp",method:"post",data:t})}function d(t){return Object(r["a"])({url:"/place/listByAppIds",method:"post",data:t})}function p(t){return Object(r["a"])({url:"aggregate/sourceListByApp",method:"post",data:t})}function f(t){return Object(r["a"])({url:"/aggregate/sourceListByAdplace",method:"post",data:t})}function m(t){return Object(r["a"])({url:"aggregate/groupListByAdplace",method:"post",data:t})}function g(t){return Object(r["a"])({url:"/userBehavior/report",method:"post",data:t})}function b(t){return Object(r["a"])({url:"/userBehavior/trend",method:"post",data:t})}function h(t){return Object(r["a"])({url:"/report/hourTrend",method:"post",data:t})}function v(t){return Object(r["a"])({url:"/report/hourReport",method:"post",data:t})}function w(t){return Object(r["a"])({url:"/report/upload",method:"post",data:t})}function y(t){return Object(r["a"])({url:"/report/record",method:"post",data:t})}function O(t){return Object(r["a"])({url:"/app/tradeList",method:"get",data:t})}function _(t){return Object(r["a"])({url:"/report/getMediaReport",method:"post",data:t})}function x(t){return Object(r["a"])({url:"/place/updateMediaReportInfo",method:"post",data:t})}function j(t){return Object(r["a"])({url:"/report/chart",method:"post",data:t})}},fcc1:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var r=a("1da1"),n=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("4de4"),a("ac1f"),a("1276"),a("00b4"),a("5319"),a("4d63"),a("2c3e"),a("25f0"),a("b0c0"),a("5f72"));var o=function(t){var e=new FileReader;return new Promise((function(a,r){e.onload=function(t){a(e.result)},e.readAsText(t,"utf-8")}))};function l(t){return s.apply(this,arguments)}function s(){return s=Object(r["a"])(regeneratorRuntime.mark((function t(e){var a,r,l,s,i,u,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:"未命名.xls",t.next=3,o(e);case 3:r=t.sent;try{l=JSON.parse(r),s=l.rspMsg||l.msg,n["Notification"].warning({title:"提示",message:s+""})}catch(d){i=window.URL.createObjectURL(e),u=document.createElement("a"),u.download=a,u.href=i,u.click(),URL.revokeObjectURL(i)}case 5:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}}}]);